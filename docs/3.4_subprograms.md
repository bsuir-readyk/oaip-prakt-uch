# 3.4. Определение подпрограмм и их описание

**Таблица 3.3 Используемые идентификаторы**

| Имя подпрограммы | Назначение подпрограммы | Заголовок подпрограммы | Имя параметра, его тип, назначение |
|---|---|---|---|
| InitAllLists | Инициализирует все списки данных программы | procedure InitAllLists(var ComponentTypesList, ComponentsList, CompatibilityList, PCBuildOptionsList, OrdersList) | ComponentTypesList: TComponentTypeList — список типов комплектующих; ComponentsList: TComponentList — список комплектующих; CompatibilityList: TCompatibilityList — список совместимости; PCBuildOptionsList: TPCBuildOptionList — список вариантов сборки; OrdersList: TOrderList — список заказов |
| LoadAllData | Загружает все данные из файлов с запросом подтверждения у пользователя | procedure LoadAllData(var ComponentTypesList, ComponentsList, CompatibilityList, OrdersList) | ComponentTypesList: TComponentTypeList — список типов комплектующих; ComponentsList: TComponentList — список комплектующих; CompatibilityList: TCompatibilityList — список совместимости; OrdersList: TOrderList — список заказов |
| SaveAllData | Сохраняет все данные в соответствующие файлы | procedure SaveAllData(const ComponentTypesList, ComponentsList, CompatibilityList, OrdersList) | ComponentTypesList: TComponentTypeList — список типов комплектующих; ComponentsList: TComponentList — список комплектующих; CompatibilityList: TCompatibilityList — список совместимости; OrdersList: TOrderList — список заказов |
| ViewList | Отображает выбранный список данных через подменю | procedure ViewList(const ComponentTypesList, ComponentsList, CompatibilityList, OrdersList, PCBuildOptionsList) | ComponentTypesList: TComponentTypeList — список типов комплектующих; ComponentsList: TComponentList — список комплектующих; CompatibilityList: TCompatibilityList — список совместимости; OrdersList: TOrderList — список заказов; PCBuildOptionsList: TPCBuildOptionList — список вариантов сборки |
| AddData | Добавляет новые данные в выбранный список через подменю | procedure AddData(var ComponentTypesList, ComponentsList, CompatibilityList) | ComponentTypesList: TComponentTypeList — список типов комплектующих; ComponentsList: TComponentList — список комплектующих; CompatibilityList: TCompatibilityList — список совместимости |
| RemoveData | Удаляет данные из выбранного списка с проверкой зависимостей | procedure RemoveData(var ComponentTypesList, ComponentsList, CompatibilityList) | ComponentTypesList: TComponentTypeList — список типов комплектующих; ComponentsList: TComponentList — список комплектующих; CompatibilityList: TCompatibilityList — список совместимости |
| EditData | Редактирует данные в выбранном списке | procedure EditData(var ComponentTypesList, ComponentsList, CompatibilityList) | ComponentTypesList: TComponentTypeList — список типов комплектующих; ComponentsList: TComponentList — список комплектующих; CompatibilityList: TCompatibilityList — список совместимости |
| HandleSpecialFunctions | Обрабатывает специальные функции: подбор ПК, заказы, поиск совместимости | procedure HandleSpecialFunctions(const ComponentTypesList, ComponentsList, CompatibilityList, var PCBuildOptionsList, OrdersList) | ComponentTypesList: TComponentTypeList — список типов комплектующих; ComponentsList: TComponentList — список комплектующих; CompatibilityList: TCompatibilityList — список совместимости; PCBuildOptionsList: TPCBuildOptionList — список вариантов сборки; OrdersList: TOrderList — список заказов |
| HandleSortData | Сортирует данные выбранного типа по заданному критерию | procedure HandleSortData(var ComponentTypesList, ComponentsList, OrdersList) | ComponentTypesList: TComponentTypeList — список типов комплектующих; ComponentsList: TComponentList — список комплектующих; OrdersList: TOrderList — список заказов |
| HandleSearchData | Выполняет поиск комплектующих по различным фильтрам | procedure HandleSearchData(const ComponentsList, ComponentTypesList) | ComponentsList: TComponentList — список комплектующих; ComponentTypesList: TComponentTypeList — список типов комплектующих |
| FindPCBuildOptions | Находит все возможные варианты сборки ПК в заданном ценовом диапазоне | function FindPCBuildOptions(const ComponentList, CompatibilityList, TypesList; MinPrice, MaxPrice: Real; var BuildOptionsList): Boolean | ComponentList: TComponentList — список комплектующих; CompatibilityList: TCompatibilityList — список совместимости; TypesList: TComponentTypeList — список типов; MinPrice, MaxPrice: Real — ценовой диапазон; BuildOptionsList: TPCBuildOptionList — результирующий список вариантов |
| CreateOrder | Оформляет заказ на основе выбранного варианта комплектации | function CreateOrder(const BuildOption; const ComponentList; var OrdersList): Boolean | BuildOption: TPCBuildOption — выбранный вариант сборки; ComponentList: TComponentList — список комплектующих; OrdersList: TOrderList — список заказов |
| FindCompatibleComponents | Находит комплектующие заданного типа, совместимые с указанной комплектующей | function FindCompatibleComponents(const ComponentList, CompatibilityList, TypesList; ComponentCode, TypeCode: Integer; var CompatibleComponents): Boolean | ComponentList: TComponentList — список комплектующих; CompatibilityList: TCompatibilityList — список совместимости; TypesList: TComponentTypeList — список типов; ComponentCode, TypeCode: Integer — коды базовой комплектующей и искомого типа; CompatibleComponents: TComponentList — результирующий список |
| DisplayMainMenu | Отображает главное меню программы | procedure DisplayMainMenu | Без параметров |
| DisplayComponents | Отображает список комплектующих с информацией о типах | procedure DisplayComponents(const List; const TypesList) | List: TComponentList — список комплектующих; TypesList: TComponentTypeList — список типов для отображения названий |
| InputComponent | Выполняет ввод данных о новой комплектующей с проверкой | function InputComponent(var Component; const TypesList, List): Boolean | Component: TComponent — структура для заполнения; TypesList: TComponentTypeList — список типов; List: TComponentList — список комплектующих для проверки уникальности |
| SaveOrderToTextFile | Сохраняет детальную информацию о заказе в текстовый файл | function SaveOrderToTextFile(const Order, BuildOption; const ComponentList; const FileName): Boolean | Order: TOrder — данные заказа; BuildOption: TPCBuildOption — данные варианта сборки; ComponentList: TComponentList — список комплектующих; FileName: string — имя файла |
| SafeReadInteger | Безопасный ввод целого числа с проверкой диапазона и команд отмены | function SafeReadInteger(const Prompt: string; MinValue, MaxValue: Integer; const ErrorMsg: string): Integer | Prompt: string — приглашение к вводу; MinValue, MaxValue: Integer — диапазон допустимых значений; ErrorMsg: string — сообщение об ошибке | 
