# Ключевые блоки схемы программы - Mermaid диаграммы

## 1. Главная программа (Main Program)

### Основной поток выполнения программы:

```mermaid
flowchart TD
    A[("Начало основной<br/>программы")] --> B["Инициализация<br/>указателей на головы<br/>списков"]
    B --> C["Инициализация<br/>счетчиков"]
    C --> D["Input_loop"]
    D --> E["Вывод<br/>информации о<br/>возможных<br/>действиях"]
    E --> F["Ввод<br/>символа<br/>определяющих<br/>очередное действие"]
    F --> G{"Введенные символы<br/>заносятся частью"}
    G -->|Да| H["Концентрация и<br/>число"]
    G -->|Нет| I["Вывод<br/>информации о<br/>некорректных<br/>символах"]
    I --> J[("A")]
    H --> K[("B")]
    J --> D
    K --> L[("Конец основной<br/>программы")]
```

### Детальное описание главной программы:
- **Инициализация указателей** - создание и настройка динамических списков для хранения данных
- **Инициализация счетчиков** - установка начальных значений переменных
- **Input_loop** - основной цикл обработки пользовательского ввода
- **Проверка символов** - валидация введенных команд
- **Обработка действий** - выполнение соответствующих операций

## 2. Система меню программы

### Главное меню с обработкой выбора:

```mermaid
flowchart TD
    A[("B")] --> B{"Полученное число"}
    B -->|1| C["Первый ввод при<br/>работе программы"]
    B -->|2| D["ViewListMenu"]
    B -->|3| E["Открытие<br/>подменю<br/>сортировок"]
    B -->|4| F["SearchMars<br/>hrutka"]
    B -->|5| G["ViewAddMe<br/>nu"]
    B -->|6| H["ViewDelete<br/>Menu"]
    B -->|7| I["ViewRedact<br/>Menu"]
    B -->|8| J["AddTrip"]
    B -->|10| K["Запись трёх<br/>списков в<br/>типизированн<br/>ые файлы"]
    B -->|"Числа < 1<br/>или > 10"| L["Вывод<br/>сообщения о<br/>некорректном<br/>вводе"]
    
    C --> M[("A")]
    D --> N[("A")]
    E --> O[("A")]
    F --> P[("A")]
    G --> Q[("A")]
    H --> R[("A")]
    I --> S[("A")]
    J --> T[("A")]
    K --> U[("A")]
    L --> V[("A")]
    
    V --> W["Input_loop<br/>Пока не равно<br/>9 или 10"]
    W --> X[("Конец основной<br/>программы")]
```

### Описание пунктов меню:
1. **Загрузка данных** - чтение информации из типизированных файлов
2. **Просмотр списков** - отображение всех категорий данных
3. **Сортировка** - упорядочивание данных по различным критериям
4. **Поиск маршруток** - фильтрация по заданным параметрам
5. **Добавление данных** - создание новых записей
6. **Удаление данных** - удаление выбранных записей
7. **Редактирование** - модификация существующих записей
8. **Добавление поездки** - планирование новых рейсов
10. **Сохранение и выход** - запись данных в файлы и завершение

## 3. Процедура EditDepartureFreeSeats

### Редактирование количества свободных мест:

```mermaid
flowchart TD
    A[("Начало процедуры<br/>EditDepartureFreeSeats")] --> B["Вывод<br/>количества<br/>свободных<br/>мест на выезде"]
    B --> C["Нахождение<br/>маршрутки<br/>соответствующую<br/>этому выезду"]
    C --> D["Подсчёт общего<br/>количества<br/>забронированных<br/>мест на этот выезд"]
    D --> E["Ввод нового<br/>количества<br/>свободных<br/>мест на выезд"]
    E --> F{"Отменяемое количество мест<br/>не должно превышать<br/>вместимость маршрутки"}
    F -->|Нет| G["Обновление<br/>количества<br/>свободных мест на<br/>этот выезд"]
    F -->|Да| H[("Конец процедуры<br/>EditDepartureFreeSeats")]
    G --> H
```

### Детальное описание процедуры:
- **Отображение текущего состояния** - показ количества доступных мест
- **Поиск связанной маршрутки** - определение транспортного средства
- **Расчет занятости** - подсчет уже забронированных мест
- **Валидация ввода** - проверка на превышение вместимости
- **Обновление данных** - применение изменений к базе данных

## 4. Процедура GetMarshrutkaNumber

### Получение и валидация номера маршрутки:

```mermaid
flowchart TD
    A[("Начало процедуры<br/>GetMarshrutkaNumber")] --> B["user_message:<br/>MessageLength;<br/>MarshrutkaNum:<br/>NumberLength;<br/>check_doubles:<br/>boolean"]
    B --> C["Создание множества<br/>допустимых букв (обычно<br/>для белорусского и<br/>латинского алфавитов)"]
    C --> D["MarshNumLoop"]
    D --> E["Вывод<br/>поясняющего<br/>сообщения<br/>пользователю"]
    E --> F["Ввод<br/>строки-<br/>номера<br/>автомобиля"]
    F --> G{"Длина выезда = 8<br/>символов"}
    G -->|Нет| H{"Все проверки первого<br/>формата номера прошли<br/>успешно"}
    G -->|Да| I["Проверка, что первые<br/>4 символа - цифры"]
    I --> J["Проверка, что пятый-<br/>шестой символы -<br/>допустимые буквы"]
    J --> K["Проверка, что<br/>последние четыре<br/>символа - цифры"]
    K --> L{"Все проверки второго<br/>формата номера прошли<br/>успешно"}
    L -->|Да| M[("J")]
    L -->|Нет| N["Проверка номера на<br/>уникальность в списке<br/>маршруток"]
    N --> O["Пока не введён<br/>корректный<br/>уникальный номер<br/>MarshNumLoop"]
    O --> P[("Конец процедуры<br/>GetMarshrutkaNumber")]
    H -->|Да| M
    H -->|Нет| O
    M --> Q[("I")]
    Q --> R["Проверка, что первый<br/>символ - цифра [1..8]"]
    R --> S["Проверка, что второй-<br/>четвертый символы -<br/>допустимые буквы"]
    S --> T["Проверка, что<br/>последние два<br/>символа - цифра [1..8]"]
    T --> U[("I")]
    U --> P
```

### Детальное описание валидации:

#### Входные параметры:
- `user_message` - текст сообщения для пользователя
- `MessageLength` - длина сообщения
- `MarshrutkaNum` - переменная для хранения номера
- `NumberLength` - длина номера
- `check_doubles` - флаг проверки уникальности

#### Форматы номеров:
**Первый формат (8 символов):**
- Позиции 1-4: цифры
- Позиции 5-6: допустимые буквы (белорусский/латинский алфавит)
- Позиции 7-8: цифры

**Второй формат (6 символов):**
- Позиция 1: цифра [1..8]
- Позиции 2-4: допустимые буквы
- Позиции 5-6: цифры [1..8]

#### Проверки:
1. **Проверка длины** - соответствие одному из допустимых форматов
2. **Проверка символов** - валидация каждой позиции
3. **Проверка уникальности** - отсутствие дублирования в системе

## 5. Общая архитектура программы

### Структура взаимодействия модулей:

```mermaid
graph TB
    A["Main Program"] --> B["Menu System"]
    A --> C["Data Initialization"]
    A --> D["File Operations"]
    
    B --> E["View Operations"]
    B --> F["Add Operations"]
    B --> G["Edit Operations"]
    B --> H["Delete Operations"]
    B --> I["Search Operations"]
    B --> J["Sort Operations"]
    
    E --> K["Dynamic Lists"]
    F --> K
    G --> K
    H --> K
    I --> K
    J --> K
    
    K --> L["Component Types"]
    K --> M["Components"]
    K --> N["Compatibility"]
    K --> O["Orders"]
    K --> P["PC Build Options"]
    
    D --> Q["Load Data"]
    D --> R["Save Data"]
    Q --> K
    R --> K
```

### Принципы работы:
- **Модульная архитектура** - разделение функциональности по модулям
- **Динамическое управление памятью** - использование связанных списков
- **Файловые операции** - сохранение/загрузка данных
- **Пользовательский интерфейс** - консольное меню с валидацией
- **Обработка ошибок** - проверка корректности данных на каждом этапе
